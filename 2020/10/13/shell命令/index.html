<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        Alliswell
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            shell 命令
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h1 id="shell-常用命令"><a href="#shell-常用命令" class="headerlink" title="shell 常用命令"></a>shell 常用命令</h1><h2 id="tools"><a href="#tools" class="headerlink" title="tools"></a>tools</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tldr #man</span><br><span class="line">cloc #统计</span><br></pre></td></tr></table></figure>

<h2 id="rpm"><a href="#rpm" class="headerlink" title="rpm"></a>rpm</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rpmbuild -ba *.spec  #编译打包rpm</span><br><span class="line">rpm -ivh *.rpm   #安装rpm包</span><br><span class="line">rpm -qpR *.rpm   #列出包依赖的库</span><br><span class="line">rpm -ql  *.rpm   #列出安装的内容</span><br><span class="line">rpm -qpl *.rpm   #列出未安装的包里内容</span><br><span class="line">rpm -qa | grep   #查找安装的相关包</span><br></pre></td></tr></table></figure>

<h2 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp [-P port] file usr@x.x.x.x:~/dir  #local to remote</span><br><span class="line">scp [-P port] usr@x.x.x.x:~/dir/file  ./dir  #remote to local</span><br></pre></td></tr></table></figure>

<h2 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp -d or -P symbolic-link dir/   #复制软连接而不是文件本身</span><br></pre></td></tr></table></figure>

<h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh [-p port] usr@x.x.x.x  #ssh登录远端</span><br></pre></td></tr></table></figure>

<h2 id="user"><a href="#user" class="headerlink" title="user"></a>user</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adduser &lt;username&gt;  #添加新用户</span><br><span class="line">usermod -aG sudo/wheel &lt;username&gt;  #用户添加到sudo组</span><br></pre></td></tr></table></figure>

<h2 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">lsb_release -a #查看系统版本信息的命令</span><br><span class="line">cat /etc/redhat-release</span><br><span class="line">uname -a</span><br><span class="line">hostnamectl</span><br><span class="line">uptime</span><br><span class="line">cat /proc/version #查看系统版本信息的命令</span><br><span class="line">cat /proc/sys/fs/inotify/max_user_watches #最大文件监控数</span><br><span class="line"><span class="meta">#</span><span class="bash"> The <span class="built_in">limit</span> can be increased to its maximum by editing /etc/sysctl.conf (except on Arch Linux, <span class="built_in">read</span> below) and adding this line to the end of the file:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> fs.inotify.max_user_watches=524288</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> The new value can <span class="keyword">then</span> be loaded <span class="keyword">in</span> by running sudo sysctl -p.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> While 524,288 is the maximum number of files that can be watched, <span class="keyword">if</span> you<span class="string">&#x27;re in an environment that is particularly memory constrained, you may wish to lower the number. Each file watch takes up 1080 bytes, so assuming that all 524,288 watches are consumed, that results in an upper bound of around 540 MiB.</span></span></span><br><span class="line"></span><br><span class="line">ls /proc[pid]  #查看进程信息</span><br><span class="line">watch -n 1 &quot;nstat | grep Tcp&quot; #查看机器网络变化信息, 排错可用</span><br><span class="line">df -lhT  #查看文件系统类型</span><br><span class="line"></span><br><span class="line">du -h --max-depth=1  #查看当前目录文件夹大小</span><br><span class="line"></span><br><span class="line">who</span><br><span class="line"></span><br><span class="line">who -Hu #查看谁可以访问</span><br><span class="line"></span><br><span class="line">grep sh$ /etc/passwd  #查看谁有shell访问权限</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> 查看是否物理机</span></span></span><br><span class="line">dmidecode -s system-manufacturer</span><br><span class="line">dmidecode -s system-product-name</span><br><span class="line">lshw -c system | grep product | head -1</span><br><span class="line">cat /sys/class/dmi/id/product_name</span><br><span class="line">cat /sys/class/dmi/id/sys_vendo</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> 查看硬件信息</span></span></span><br><span class="line">lscpu or cat /proc/cpuinfo</span><br><span class="line">lsmem or cat /proc/meminfo</span><br><span class="line">ifconfig -a</span><br><span class="line">ethtool &lt;devname&gt;</span><br><span class="line">lshw</span><br><span class="line">lspci</span><br><span class="line">dmidecode</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> 查看进程和服务</span></span></span><br><span class="line">pstree -pa 1</span><br><span class="line">ps -ef</span><br><span class="line">ps auxf</span><br><span class="line">systemctl</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> 网路</span></span></span><br><span class="line">netstat -tulpn</span><br><span class="line">netstat -anp</span><br><span class="line">lsof -i</span><br><span class="line">ss</span><br><span class="line">iptables -L -n</span><br><span class="line">cat /etc/resolv.conf</span><br><span class="line">ss -ln | head -n1 ;ss -ln | grep 8000</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> 内核</span></span></span><br><span class="line">[https://www.oreilly.com/library/view/red-hat-enterprise/9781785283550/ch10s05.html](https://www.oreilly.com/library/view/red-hat-enterprise/9781785283550/ch10s05.html)</span><br><span class="line">uname -r</span><br><span class="line">cat /proc/cmdline</span><br><span class="line">lsmod</span><br><span class="line">modinfo &lt;module&gt;</span><br><span class="line">sysctl -a</span><br><span class="line">cat /boot/grub2/grub.cfg</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="string"> 日志</span></span></span><br><span class="line">dmesg</span><br><span class="line">tail -f /var/log/messages</span><br><span class="line">journalctl</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">strace#</span><span class="bash"><span class="string"> 追踪</span></span></span><br><span class="line"></span><br><span class="line">lspci -k | grep -A 2 -i &quot;VGA&quot; #查看显卡</span><br></pre></td></tr></table></figure>

<h2 id="git"><a href="#git" class="headerlink" title="git"></a>git</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git archive --prefix=output/ -o &quot;../output.tar.gz&quot; develop  #git库打包</span><br><span class="line">git reflog # 查看本地记录</span><br></pre></td></tr></table></figure>

<h2 id="yum"><a href="#yum" class="headerlink" title="yum"></a>yum</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum reinstall packagename  #可以在/var/cache/yum目录下找到包</span><br><span class="line">yum provides *.so.version  #查询哪个包提供这个库</span><br></pre></td></tr></table></figure>

<h2 id="pkg-config"><a href="#pkg-config" class="headerlink" title="pkg-config"></a>pkg-config</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg-config --variable pc_path pkg-config #查看pc路径</span><br></pre></td></tr></table></figure>

<h2 id="make"><a href="#make" class="headerlink" title="make"></a>make</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make V=1 #展示出具体编译命令</span><br></pre></td></tr></table></figure>

<h2 id="code"><a href="#code" class="headerlink" title="code"></a>code</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> get all filename <span class="keyword">in</span> specified path</span></span><br><span class="line"></span><br><span class="line">path=$1</span><br><span class="line">files=$(ls $path)</span><br><span class="line">for file in $files</span><br><span class="line">do</span><br><span class="line">  mv $file &#x27;bad-&#x27;$file</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">rename</span><br><span class="line">for i in `ls *.wav`;do mv $i `echo $i| sed &#x27;s/-cmd//g&#x27;`; done;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="firewall"><a href="#firewall" class="headerlink" title="firewall"></a>firewall</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw status</span><br><span class="line">sudo ufw enable</span><br><span class="line">sudo ufw allow 22</span><br><span class="line">sudo ufw reload</span><br><span class="line">sudo ufw delete allow 21</span><br></pre></td></tr></table></figure>

<h2 id="file"><a href="#file" class="headerlink" title="file"></a>file</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">in ext4</span><br><span class="line">1：找到文件或目录的索引节点号</span><br><span class="line"></span><br><span class="line">ls -i filename</span><br><span class="line"></span><br><span class="line">2：找到文件所在的分区或VG</span><br><span class="line"></span><br><span class="line">  df -T</span><br><span class="line"></span><br><span class="line">3：使用debugfs找到文件的创建时间（crtime）</span><br><span class="line"></span><br><span class="line">debugfs -R &#x27;stat &lt;xxx&gt;&#x27; /dev/xxxx</span><br><span class="line"></span><br><span class="line">4:批量修改文件大小写</span><br><span class="line">for file in * ;</span><br><span class="line"></span><br><span class="line">do mv  $file `echo $file |  tr &#x27;A-Z&#x27; &#x27;a-z&#x27;`;</span><br><span class="line"></span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker exec -it docker-compose_minio2_1 /bin/sh  #进入docker容器</span><br></pre></td></tr></table></figure>

<h2 id="PMS"><a href="#PMS" class="headerlink" title="PMS"></a>PMS</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">将包（ebms.tar.gz) scp到本地分成7z包</span><br><span class="line"></span><br><span class="line">7z a SR300088.代码.[媒体业务产品部].MS.7z ebms.tar.gz -v9m</span><br><span class="line"></span><br><span class="line">(0) 将文档目录打成7z包</span><br><span class="line"></span><br><span class="line">7z a &#x27;SR300150.文档.[媒体业务产品部].MS&#x27;.7z &#x27;SR300150.文档.[媒体业务产品部].MS&#x27;</span><br><span class="line"></span><br><span class="line">(1) 将文档目录打成zip包</span><br><span class="line"></span><br><span class="line">zip -r &#x27;SR300175.文档.[媒体业务产品部].MRF.transcode&#x27;.zip &#x27;SR300175.文档.[媒体业务产品部].MRF.transcode&#x27;</span><br></pre></td></tr></table></figure>

    </div>

    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2020 <a class="flink" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>-<a class="flink" target="_blank" rel="noopener" href="https://github.com/sanjinhub/hexo-theme-geek">Geek</a>.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="white">
<input type="hidden" id="valine_appid" value="ueIePJtaGryN9FhXJieFg0zv-MdYXbMMI">
<input type="hidden" id="valine_appKey" value="YrCpNBNF8jxrR28HotIjP2Gb">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>